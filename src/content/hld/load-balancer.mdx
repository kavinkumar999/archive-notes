---
title: Load Balancer Deep Dive
tags: HLD
---

Load balancers distribute incoming ğŸ“¢ network traffic ğŸš— across multiple ğŸ’» servers to ensure high ğŸ”´ availability and reliability. Effective load balancing improves ğŸ“ˆ performance by optimizing resource â™»ï¸ use, maximizing throughput, reducing â³ latency, and ensuring fault tolerance.

<MDXImage src="/png/hld/load-balancer.png" alt="Load Balancer" />

## ğŸ”§ Types of Load Balancing Algorithms

### 1. â­ **Round Robin**
- **ğŸ”:** Distributes requests sequentially â© to each server in the pool.
- **ğŸ’¼:** Effective when all servers have similar capabilities and resource availability.
- **ğŸ“:**
  - ğŸ“¦ Server Pool: A, B, C
  - ğŸ“ Incoming requests: 1, 2, 3, 4, 5
  - ğŸ“¢ Request Distribution: 1 -> A, 2 -> B, 3 -> C, 4 -> A, 5 -> B

#### âœ… Advantages:
- Simple to implement.
- Fair distribution when servers have similar âš™ï¸ loads.

#### â›” Disadvantages:
- Ignores server performance or load.
- Can overload slower servers.


### 2. â­ **Weighted Round Robin**
- **ğŸ”:** Assigns weights âš–ï¸ to servers based on their capacity. Servers with higher weights â†‘ receive more requests.
- **ğŸ’¼:** Useful when servers have different processing capacities.
- **ğŸ“:**
  - ğŸ“¦ Server A (weight 3), Server B (weight 1)
  - ğŸ“¢ Request Distribution: A, A, A, B, A, A, A, B

#### âœ… Advantages:
- Accounts for server capacity differences.

#### â›” Disadvantages:
- Still static; doesnâ€™t adapt to dynamic changes in server load.

---

### 3. â­ **Least Connections**
- **ğŸ”:** Routes traffic ğŸ“¥ to the server with the fewest active ğŸ› ï¸ connections.
- **ğŸ’¼:** Suitable for environments with long-lived connections.
- **ğŸ“:**
  - ğŸ“¦ Server A: 3 connections, Server B: 1 connection
  - ğŸ“¢ New request goes to Server B.

#### âœ… Advantages:
- Balances based on current server load.

#### â›” Disadvantages:
- May not account for connection types or resource usage.

### 4. â­ **IP Hash**
- **ğŸ”:** Uses a ğŸ”‘ hash function based on the clientâ€™s IP address to determine the server.
- **ğŸ’¼:** Ensures a client is consistently routed to the same server.
- **ğŸ“:**
  - Hash(Client IP) % Number of Servers
  - Client 192.168.1.1 always goes to Server A.

#### âœ… Advantages:
- Useful for session persistence.

#### â›” Disadvantages:
- Poor load distribution if client IPs are unevenly distributed.

### 5. â­ **Random**
- **ğŸ”:** Selects a server randomly ğŸ”.
- **ğŸ’¼:** Simple distribution when server loads are approximately equal.
- **ğŸ“:**
  - ğŸ“¦ Server Pool: A, B, C
  - ğŸ“¢ Request Distribution: 1 -> B, 2 -> A, 3 -> C

#### âœ… Advantages:
- Simple and effective with homogeneous servers.

#### â›” Disadvantages:
- Does not consider server load or capacity.

### 6. â­ **Least Response Time**
- **ğŸ”:** Routes traffic to the server with the lowest response time.
- **ğŸ’¼:** Ideal for environments where response times vary.

#### âœ… Advantages:
- Optimizes ğŸ”„ performance by considering server response speeds.

#### â›” Disadvantages:
- Requires real-time âŒ› monitoring of server response times.

### 7. â­ **Dynamic Load Balancing**
- **ğŸ”:** Continuously monitors ğŸ”” server load and dynamically adjusts traffic distribution.
- **ğŸ’¼:** Suitable for highly variable workloads.

#### âœ… Advantages:
- Adapts to changing server conditions.

#### â›” Disadvantages:
- More complex to implement and maintain.

## ğŸ—ï¸ **Stateful vs Stateless Load Balancing**

| **Type** | **Definition** | **Use Case** | **How It Works** | **Advantages** | **Disadvantages** |
| --- | --- | --- | --- | --- | --- |
| **Stateful** | Tracks and stores client session information | Session persistence, personalized user experiences | Directs client to specific server, maintains session consistency | Ensures user session continuity | Complexity in managing session data, limited scalability |
| **Stateless** | Does not store session information, treats each request independently | RESTful APIs, microservices, high scalability systems | Routes client request to any available server, no session context needed | Simpler to scale and maintain, reduces server memory overhead | Cannot natively maintain session continuity |


## **Layer 4 vs. Layer 7 Load Balancing**

### ğŸ”’ **Layer 4 Load Balancing**
- **Definition:** Operates at the transport layer of the OSI model.
- **Function:** Directs traffic based on IP addresses and ports.
- **Advantages:** Simple and fast due to minimal data inspection.
- **Disadvantages:** Lacks ability to make decisions based on application-specific data.

### ğŸŒ **Layer 7 Load Balancing**
- **Definition:** Operates at the application layer of the OSI model.
- **Function:** Directs traffic based on HTTP headers, cookies, and request content.
- **Advantages:** Supports sophisticated traffic management such as routing by URLs or user agents.
- **Disadvantages:** More complex and slower due to deep packet inspection.